<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MQL Brand Follow-Up Activity Report â€” Q1 2026</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  background: #f0f2f5;
  color: #1a1a2e;
  line-height: 1.6;
}
.header {
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: #fff;
  padding: 32px 40px 0;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}
.header h1 {
  font-size: 24px;
  font-weight: 700;
  letter-spacing: -0.3px;
}
.header .subtitle {
  font-size: 14px;
  color: #a8b2d1;
  margin-top: 4px;
  margin-bottom: 16px;
}
.tabs {
  display: flex;
  gap: 4px;
}
.tab-btn {
  background: transparent;
  border: none;
  color: #a8b2d1;
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  border-radius: 8px 8px 0 0;
  transition: all 0.2s;
  font-family: inherit;
}
.tab-btn:hover { background: rgba(255,255,255,0.08); color: #fff; }
.tab-btn.active { background: #f0f2f5; color: #1a1a2e; font-weight: 600; }
.main { max-width: 1400px; margin: 0 auto; padding: 24px 24px 60px; }
.tab-content { display: none; }
.tab-content.active { display: block; }

/* Cards */
.metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
  gap: 16px;
  margin-bottom: 28px;
}
.metric-card {
  background: #fff;
  border-radius: 12px;
  padding: 24px;
  text-align: center;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  transition: transform 0.15s, box-shadow 0.15s;
}
.metric-card:hover { transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0,0,0,0.1); }
.metric-card .number {
  font-size: 36px;
  font-weight: 700;
  line-height: 1.1;
}
.metric-card .label {
  font-size: 13px;
  color: #64748b;
  margin-top: 6px;
  font-weight: 500;
}
.metric-card.blue .number { color: #2563eb; }
.metric-card.green .number { color: #16a34a; }
.metric-card.amber .number { color: #d97706; }
.metric-card.red .number { color: #dc2626; }
.metric-card.purple .number { color: #7c3aed; }
.metric-card.teal .number { color: #0d9488; }

.card {
  background: #fff;
  border-radius: 12px;
  padding: 28px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  margin-bottom: 20px;
}
.card h3 {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 12px;
  color: #1a1a2e;
}
.insight-text {
  font-size: 14px;
  color: #475569;
  line-height: 1.7;
  margin-bottom: 10px;
}
.insight-text:last-child { margin-bottom: 0; }
.note-box {
  background: #f8fafc;
  border-left: 4px solid #2563eb;
  border-radius: 0 8px 8px 0;
  padding: 16px 20px;
  margin-top: 16px;
  font-size: 13px;
  color: #475569;
}

/* Tables */
.table-wrapper {
  overflow-x: auto;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}
table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}
thead th {
  background: #f8fafc;
  padding: 12px 14px;
  text-align: left;
  font-weight: 600;
  color: #334155;
  border-bottom: 2px solid #e2e8f0;
  white-space: nowrap;
  cursor: pointer;
  user-select: none;
  position: relative;
}
thead th:hover { background: #eef2f7; }
thead th .sort-icon { font-size: 10px; margin-left: 4px; opacity: 0.4; }
thead th.sort-asc .sort-icon, thead th.sort-desc .sort-icon { opacity: 1; color: #2563eb; }
tbody td {
  padding: 10px 14px;
  border-bottom: 1px solid #f1f5f9;
  color: #334155;
}
tbody tr:hover { background: #f8fafc; }
tbody tr:last-child td { border-bottom: none; }
.traffic-val { text-align: right; font-variant-numeric: tabular-nums; }
.amount-val { text-align: right; font-weight: 600; font-variant-numeric: tabular-nums; }

/* Badges */
.badge {
  display: inline-block;
  padding: 3px 10px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  letter-spacing: 0.3px;
  white-space: nowrap;
}
.badge-engaged { background: #dcfce7; color: #166534; }
.badge-qualified { background: #dbeafe; color: #1e40af; }
.badge-proposal { background: #fef3c7; color: #92400e; }
.badge-closed-lost { background: #fee2e2; color: #991b1b; }
.badge-active { background: #dcfce7; color: #166534; }
.badge-needs-followup { background: #fef9c3; color: #854d0e; }
.badge-at-risk { background: #fee2e2; color: #991b1b; }
.badge-no-followup { background: #f1f5f9; color: #475569; }
.badge-dq { background: #ede9fe; color: #5b21b6; }

/* Filters */
.filter-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
  margin-bottom: 16px;
}
.filter-bar label {
  font-size: 13px;
  font-weight: 500;
  color: #475569;
}
.filter-bar select, .filter-bar input[type="text"] {
  padding: 8px 12px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 13px;
  font-family: inherit;
  background: #fff;
  color: #1a1a2e;
  outline: none;
  transition: border-color 0.15s;
}
.filter-bar select:focus, .filter-bar input:focus { border-color: #2563eb; box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
.showing-count {
  font-size: 13px;
  color: #64748b;
  font-weight: 500;
}

/* Charts */
.charts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
  gap: 20px;
}
.chart-card {
  background: #fff;
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}
.chart-card h3 {
  font-size: 15px;
  font-weight: 600;
  color: #1a1a2e;
  margin-bottom: 16px;
}
.chart-card canvas { max-height: 340px; }
.chart-card-full {
  grid-column: 1 / -1;
}

/* Footer */
.footer {
  text-align: center;
  padding: 24px;
  font-size: 12px;
  color: #94a3b8;
  border-top: 1px solid #e2e8f0;
  margin-top: 40px;
}
.summary-row {
  display: flex;
  flex-wrap: wrap;
  gap: 24px;
  margin-bottom: 20px;
}
.summary-item {
  font-size: 14px;
  color: #475569;
}
.summary-item strong { color: #1a1a2e; }
.section-title {
  font-size: 20px;
  font-weight: 700;
  color: #1a1a2e;
  margin-bottom: 8px;
}
.section-subtitle {
  font-size: 14px;
  color: #64748b;
  margin-bottom: 20px;
}
</style>
</head>
<body>

<div class="header">
  <h1>MQL Brand Follow-Up Activity Report &mdash; Q1 2026</h1>
  <p class="subtitle">Insights into sales engagement patterns across 50 MQL brands</p>
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('summary')">Summary</button>
    <button class="tab-btn" onclick="switchTab('opportunities')">With Opportunities (12)</button>
    <button class="tab-btn" onclick="switchTab('no-opportunities')">Without Opportunities (38)</button>
    <button class="tab-btn" onclick="switchTab('charts')">Overview &amp; Charts</button>
  </div>
</div>

<div class="main">

<!-- ======================== TAB 1: SUMMARY ======================== -->
<div id="tab-summary" class="tab-content active">
  <div class="metrics-grid">
    <div class="metric-card blue">
      <div class="number">50</div>
      <div class="label">Total MQL Brands</div>
    </div>
    <div class="metric-card green">
      <div class="number">12</div>
      <div class="label">With Opportunities</div>
    </div>
    <div class="metric-card amber">
      <div class="number">38</div>
      <div class="label">Without Opportunities Yet</div>
    </div>
    <div class="metric-card teal">
      <div class="number">$500,442</div>
      <div class="label">Total Pipeline Value</div>
    </div>
    <div class="metric-card purple">
      <div class="number">1</div>
      <div class="label">Disqualified (DQ)</div>
    </div>
    <div class="metric-card red">
      <div class="number">1</div>
      <div class="label">Closed Lost</div>
    </div>
  </div>

  <div class="metrics-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px,1fr));">
    <div class="metric-card teal">
      <div class="number">66</div>
      <div class="label">Total Meetings Booked</div>
    </div>
  </div>

  <div class="card">
    <h3>Key Insights</h3>
    <p class="insight-text">These 50 brands represent strong inbound interest generated through <strong>marketing outbound email, LinkedIn outreach, and paid advertising campaigns</strong>. Ensuring consistent follow-up after meetings could help convert more prospects into opportunities.</p>
    <p class="insight-text">Of the 50 MQL brands, <strong>12 have progressed to active opportunities</strong> with a combined pipeline value of <strong>$500,442</strong>. The remaining 38 brands are at various stages of engagement and represent additional conversion potential.</p>
    <p class="insight-text">Among the 38 companies without opportunities, several show strong engagement with multiple meetings and touchpoints recorded. These companies may benefit from continued outreach to advance the conversation.</p>
    <div class="note-box">
      <strong>Important note:</strong> This report captures activity logged in HubSpot, specifically outbound emails and meetings. Additional follow-ups via phone calls, LinkedIn messages, or in-person meetings may not be reflected here. The data should be interpreted as a partial view of overall sales engagement.
    </div>
  </div>

  <div class="card">
    <h3>Acquisition Channels</h3>
    <p class="insight-text">Brands in this report were sourced through three primary channels:</p>
    <ul style="margin-left: 20px; margin-top: 8px; font-size: 14px; color: #475569;">
      <li style="margin-bottom: 6px;"><strong>Marketing Outbound Email</strong> &mdash; Targeted email campaigns to qualified prospects</li>
      <li style="margin-bottom: 6px;"><strong>LinkedIn Outreach</strong> &mdash; Direct engagement through LinkedIn messaging and connection requests</li>
      <li style="margin-bottom: 6px;"><strong>Paid Advertising</strong> &mdash; Inbound interest generated from paid ad campaigns</li>
    </ul>
  </div>

  <div class="card">
    <h3>Status Breakdown for Non-Opportunity Companies</h3>
    <div class="summary-row" style="margin-top: 12px;">
      <div class="summary-item"><span class="badge badge-active">ACTIVE</span> &nbsp;<strong>20</strong> companies with recent activity</div>
      <div class="summary-item"><span class="badge badge-needs-followup">NEEDS FOLLOW-UP</span> &nbsp;<strong>5</strong> companies where additional engagement may be beneficial</div>
      <div class="summary-item"><span class="badge badge-at-risk">AT RISK</span> &nbsp;<strong>11</strong> companies that may benefit from re-engagement</div>
      <div class="summary-item"><span class="badge badge-no-followup">NO FOLLOW-UP</span> &nbsp;<strong>2</strong> companies with an opportunity for additional outreach</div>
      <div class="summary-item"><span class="badge badge-dq">DQ</span> &nbsp;<strong>1</strong> prospect chose not to proceed</div>
    </div>
    <div class="note-box" style="margin-top: 8px;">
      "No Follow-Up" and "Needs Follow-Up" labels indicate that no additional outbound emails were recorded in HubSpot after the most recent meeting. Follow-up activity may have occurred through other channels.
    </div>
  </div>
</div>

<!-- ======================== TAB 2: OPPORTUNITIES ======================== -->
<div id="tab-opportunities" class="tab-content">
  <div class="section-title">Companies with Opportunities</div>
  <div class="section-subtitle">12 companies that have progressed to the opportunity stage</div>

  <div class="summary-row">
    <div class="summary-item"><strong>Total Pipeline:</strong> $500,442</div>
    <div class="summary-item"><strong>Avg Deal Amount:</strong> $41,704</div>
    <div class="summary-item"><strong>Avg Follow-ups After Opportunity:</strong> 5.6</div>
    <div class="summary-item"><strong>Stages:</strong> 8 Engaged &middot; 2 Qualified &middot; 1 Proposal &middot; 1 Closed Lost</div>
  </div>

  <div class="table-wrapper">
    <table id="oppo-table">
      <thead>
        <tr>
          <th onclick="sortTable('oppo-table',0)">Company <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',1)">Domain <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',2)">Traffic <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',3)">Sales Owner <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',4)">Meetings <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',5)">Last Meeting <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',6)">Outbound Emails <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',7)">Total Touchpoints <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',8)">Deal Name <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',9)">Stage <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',10)">Amount <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',11)">Created <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('oppo-table',12)">Follow-ups After Oppo <span class="sort-icon">&#9650;&#9660;</span></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><strong>Saintjavelin</strong></td><td>saintjavelin.com</td><td class="traffic-val">131,700</td><td>Gregory Unger</td><td>1</td><td>2026-01-08</td><td>1</td><td>2</td><td>Saint Javelin</td><td><span class="badge badge-qualified">Qualified</span></td><td class="amount-val">$40,000</td><td>2026-01-09</td><td>0</td>
        </tr>
        <tr>
          <td><strong>Bern Helmets</strong></td><td>bernhelmets.com</td><td class="traffic-val">&mdash;</td><td>Gregory Unger</td><td>2</td><td>2026-01-13</td><td>5</td><td>7</td><td>Bern Helmets</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$20,000</td><td>2026-01-13</td><td>7</td>
        </tr>
        <tr>
          <td><strong>TruKid</strong></td><td>trukid.com</td><td class="traffic-val">&mdash;</td><td>Gregory Unger</td><td>2</td><td>2026-01-05</td><td>2</td><td>4</td><td>TruKid - New Deal</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$30,000</td><td>2026-01-06</td><td>2</td>
        </tr>
        <tr>
          <td><strong>norasnursery.com</strong></td><td>norasnursery.com</td><td class="traffic-val">&mdash;</td><td>Gregory Unger</td><td>1</td><td>2026-02-13</td><td>2</td><td>3</td><td>norasnursery.com - New Deal 2</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$20,000</td><td>2026-02-13</td><td>3</td>
        </tr>
        <tr>
          <td><strong>Grayl</strong></td><td>grayl.com</td><td class="traffic-val">126,497</td><td>Gregory Unger</td><td>1</td><td>2025-12-19</td><td>4</td><td>5</td><td>Grayl - New Deal</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$20,000</td><td>2026-01-08</td><td>1</td>
        </tr>
        <tr>
          <td><strong>Kringle Candle</strong></td><td>kringlecandle.com</td><td class="traffic-val">&mdash;</td><td>Gregory Unger</td><td>1</td><td>2026-01-08</td><td>4</td><td>5</td><td>Kringle Candle</td><td><span class="badge badge-proposal">Proposal</span></td><td class="amount-val">$20,000</td><td>2026-01-09</td><td>4</td>
        </tr>
        <tr>
          <td><strong>Rayconglobal</strong></td><td>rayconglobal.com</td><td class="traffic-val">969,028</td><td>Brad Noble</td><td>3</td><td>2026-01-29</td><td>24</td><td>27</td><td>Raycon Global - XBD</td><td><span class="badge badge-closed-lost">Closed Lost</span></td><td class="amount-val">$230,000</td><td>2026-01-23</td><td>13</td>
        </tr>
        <tr>
          <td><strong>Goral-Shoes</strong></td><td>goral-shoes.co.uk</td><td class="traffic-val">58,513</td><td>Ash Luker</td><td>3</td><td>2026-02-09</td><td>21</td><td>24</td><td>Goral Shoes - XBD</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$20,000</td><td>2026-02-02</td><td>20</td>
        </tr>
        <tr>
          <td><strong>Revival Vintage</strong></td><td>revivalvintage.co.uk</td><td class="traffic-val">&mdash;</td><td>Gregory Unger</td><td>2</td><td>2026-01-14</td><td>19</td><td>21</td><td>Revival Vintage - XBD</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$31,442</td><td>2026-01-29</td><td>4</td>
        </tr>
        <tr>
          <td><strong>Mott &amp; Bow</strong></td><td>mottandbow.com</td><td class="traffic-val">389,842</td><td>Brad Noble</td><td>1</td><td>2025-12-18</td><td>19</td><td>20</td><td>Mott &amp; Bow - XBD</td><td><span class="badge badge-qualified">Qualified</span></td><td class="amount-val">$25,000</td><td>2026-02-02</td><td>3</td>
        </tr>
        <tr>
          <td><strong>Rowen &amp; Wren</strong></td><td>rowenandwren.co.uk</td><td class="traffic-val">&mdash;</td><td>Ash Luker</td><td>1</td><td>2026-01-08</td><td>25</td><td>26</td><td>Rowen &amp; Wren - XBD</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$24,000</td><td>2026-01-29</td><td>9</td>
        </tr>
        <tr>
          <td><strong>Country Life</strong></td><td>countrylifevitamins.com</td><td class="traffic-val">&mdash;</td><td>Gregory Unger</td><td>1</td><td>2026-02-13</td><td>1</td><td>2</td><td>Country Life - 2026-02-12</td><td><span class="badge badge-engaged">Engaged</span></td><td class="amount-val">$20,000</td><td>2026-02-13</td><td>1</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ======================== TAB 3: NO OPPORTUNITIES ======================== -->
<div id="tab-no-opportunities" class="tab-content">
  <div class="section-title">Companies without Opportunities</div>
  <div class="section-subtitle">38 companies that have not yet progressed to an opportunity</div>

  <div class="filter-bar">
    <label for="filter-status">Status:</label>
    <select id="filter-status" onchange="filterNoOppoTable()">
      <option value="all">All Statuses</option>
      <option value="ACTIVE">Active</option>
      <option value="NEEDS FOLLOW-UP">Needs Follow-Up</option>
      <option value="AT RISK">At Risk</option>
      <option value="NO FOLLOW-UP">No Follow-Up</option>
      <option value="DQ">DQ</option>
    </select>
    <label for="filter-owner">Sales Owner:</label>
    <select id="filter-owner" onchange="filterNoOppoTable()">
      <option value="all">All Owners</option>
      <option value="Gregory Unger">Gregory Unger</option>
      <option value="Brad Noble">Brad Noble</option>
      <option value="Ash Luker">Ash Luker</option>
      <option value="Ryan Leahy">Ryan Leahy</option>
      <option value="Daniel Rosen">Daniel Rosen</option>
      <option value="Darwish Gani">Darwish Gani</option>
      <option value="">Unassigned</option>
    </select>
    <label for="filter-followups">Follow-ups:</label>
    <select id="filter-followups" onchange="filterNoOppoTable()">
      <option value="all">All</option>
      <option value="0">0 Follow-ups</option>
      <option value="1-3">1 &ndash; 3</option>
      <option value="4+">4+</option>
    </select>
    <label for="filter-search">Search:</label>
    <input type="text" id="filter-search" placeholder="Company or domain..." oninput="filterNoOppoTable()" style="width: 180px;">
    <span id="showing-count" class="showing-count">Showing 38 of 38</span>
  </div>

  <div class="table-wrapper">
    <table id="no-oppo-table">
      <thead>
        <tr>
          <th onclick="sortTable('no-oppo-table',0)">Company <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',1)">Domain <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',2)">Traffic <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',3)">Sales Owner <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',4)">Meetings <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',5)">Last Meeting <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',6)">Days Since <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',7)">Outbound Emails <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',8)">Total Touchpoints <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',9)">Follow-ups After Meeting <span class="sort-icon">&#9650;&#9660;</span></th>
          <th onclick="sortTable('no-oppo-table',10)">Status <span class="sort-icon">&#9650;&#9660;</span></th>
        </tr>
      </thead>
      <tbody id="no-oppo-tbody">
      </tbody>
    </table>
  </div>
</div>

<!-- ======================== TAB 4: CHARTS ======================== -->
<div id="tab-charts" class="tab-content">
  <div class="section-title">Overview &amp; Charts</div>
  <div class="section-subtitle">Visual insights into pipeline, engagement, and activity distribution</div>

  <div class="charts-grid">
    <div class="chart-card">
      <h3>Opportunity Pipeline by Stage</h3>
      <canvas id="chart-pipeline"></canvas>
    </div>
    <div class="chart-card">
      <h3>Status Distribution &mdash; Non-Opportunity Companies</h3>
      <canvas id="chart-status"></canvas>
    </div>
    <div class="chart-card chart-card-full">
      <h3>Follow-ups After Opportunity Created</h3>
      <canvas id="chart-followups"></canvas>
    </div>
    <div class="chart-card">
      <h3>Top 10 Most Engaged Non-Opportunity Companies (by Touchpoints)</h3>
      <canvas id="chart-top10"></canvas>
    </div>
    <div class="chart-card">
      <h3>Activity by Sales Owner (Meetings + Emails)</h3>
      <canvas id="chart-owners"></canvas>
    </div>
  </div>
</div>

</div><!-- /main -->

<div class="footer">
  Report generated Feb 19, 2026 &middot; Data source: HubSpot CRM &middot; Touchpoints = Outbound Emails + Meetings
</div>

<script>
// ======================== TAB SWITCHING ========================
function switchTab(id) {
  document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
  document.getElementById('tab-' + id).classList.add('active');
  const tabs = ['summary','opportunities','no-opportunities','charts'];
  const idx = tabs.indexOf(id);
  document.querySelectorAll('.tab-btn')[idx].classList.add('active');
  if (id === 'charts' && !window.chartsRendered) {
    renderCharts();
    window.chartsRendered = true;
  }
}

// ======================== NON-OPPORTUNITY DATA ========================
const noOppoData = [
  {company:"Anatomie",domain:"anatomie.com",traffic:65164,owner:"Gregory Unger",meetings:2,lastMeeting:"2026-02-27",daysSince:-10,emails:0,touchpoints:2,followups:0,status:"ACTIVE"},
  {company:"Brandon Blackwood New York",domain:"brandonblackwood.com",traffic:159205,owner:"Ryan Leahy",meetings:4,lastMeeting:"2026-02-17",daysSince:0,emails:6,touchpoints:10,followups:0,status:"ACTIVE"},
  {company:"Buddha Jewelry",domain:"buddhajewelry.com",traffic:48389,owner:"",meetings:0,lastMeeting:"",daysSince:null,emails:0,touchpoints:0,followups:0,status:"ACTIVE"},
  {company:"Cass Art",domain:"cassart.co.uk",traffic:null,owner:"Ash Luker",meetings:1,lastMeeting:"2026-02-20",daysSince:-3,emails:5,touchpoints:6,followups:0,status:"ACTIVE"},
  {company:"Deux Par Deux",domain:"deuxpardeux.com",traffic:68614,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-30",daysSince:18,emails:0,touchpoints:1,followups:0,status:"DQ"},
  {company:"Knkg",domain:"knkg.com",traffic:76700,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-04",daysSince:13,emails:0,touchpoints:1,followups:0,status:"NEEDS FOLLOW-UP"},
  {company:"Krewe",domain:"krewe.com",traffic:102495,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-09",daysSince:39,emails:5,touchpoints:6,followups:0,status:"NO FOLLOW-UP"},
  {company:"Loogguitars",domain:"loogguitars.com",traffic:65324,owner:"Brad Noble",meetings:1,lastMeeting:"2026-02-25",daysSince:-8,emails:0,touchpoints:1,followups:0,status:"ACTIVE"},
  {company:"Matethelabel",domain:"matethelabel.com",traffic:111660,owner:"Daniel Rosen",meetings:1,lastMeeting:"2026-02-19",daysSince:-2,emails:2,touchpoints:3,followups:0,status:"ACTIVE"},
  {company:"Monsterbass",domain:"monsterbass.com",traffic:132827,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-11",daysSince:6,emails:1,touchpoints:2,followups:0,status:"ACTIVE"},
  {company:"Namawell",domain:"namawell.com",traffic:304875,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-11",daysSince:6,emails:0,touchpoints:1,followups:0,status:"ACTIVE"},
  {company:"Nuudii System",domain:"nuudiisystem.com",traffic:31197,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-09",daysSince:8,emails:1,touchpoints:2,followups:0,status:"NEEDS FOLLOW-UP"},
  {company:"Ritani",domain:"ritani.com",traffic:334976,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-18",daysSince:-1,emails:0,touchpoints:1,followups:0,status:"ACTIVE"},
  {company:"RoseSkinCo.",domain:"roseskinco.com",traffic:null,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-19",daysSince:-2,emails:1,touchpoints:2,followups:0,status:"ACTIVE"},
  {company:"Samplize (Material Bank)",domain:"samplize.com",traffic:368524,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-06",daysSince:13,emails:3,touchpoints:4,followups:3,status:"ACTIVE"},
  {company:"Soma Energetics",domain:"somaenergetics.com",traffic:null,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-27",daysSince:21,emails:0,touchpoints:1,followups:0,status:"NO FOLLOW-UP"},
  {company:"True Nutrition",domain:"truenutrition.com",traffic:135149,owner:"Gregory Unger",meetings:4,lastMeeting:"2026-02-18",daysSince:-1,emails:0,touchpoints:4,followups:0,status:"ACTIVE"},
  {company:"Wild Science Lab",domain:"wildsciencelab.com",traffic:null,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-18",daysSince:-1,emails:1,touchpoints:2,followups:0,status:"ACTIVE"},
  {company:"Woojer",domain:"woojer.com",traffic:193483,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-18",daysSince:-1,emails:0,touchpoints:1,followups:0,status:"ACTIVE"},
  {company:"Yosi Samra",domain:"yosisamra.com",traffic:null,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-18",daysSince:-1,emails:1,touchpoints:2,followups:0,status:"ACTIVE"},
  {company:"pampeano",domain:"pampeano.com",traffic:null,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-18",daysSince:-1,emails:0,touchpoints:1,followups:0,status:"ACTIVE"},
  {company:"Dieux",domain:"dieuxskin.com",traffic:173766,owner:"Ryan Leahy",meetings:3,lastMeeting:"2026-01-07",daysSince:41,emails:1,touchpoints:4,followups:1,status:"NEEDS FOLLOW-UP"},
  {company:"Iam8Bit",domain:"iam8bit.com",traffic:328815,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-02",daysSince:15,emails:1,touchpoints:2,followups:1,status:"NEEDS FOLLOW-UP"},
  {company:"Myconquering",domain:"myconquering.com",traffic:88360,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-28",daysSince:20,emails:1,touchpoints:2,followups:1,status:"NEEDS FOLLOW-UP"},
  {company:"Thorum",domain:"thorum.com",traffic:192795,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-06",daysSince:11,emails:1,touchpoints:2,followups:1,status:"NEEDS FOLLOW-UP"},
  {company:"Faherty Brand",domain:"fahertybrand.com",traffic:708856,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-23",daysSince:25,emails:5,touchpoints:6,followups:2,status:"AT RISK"},
  {company:"Loveinfaith",domain:"loveinfaith.life",traffic:956157,owner:"Brad Noble",meetings:2,lastMeeting:"2026-01-14",daysSince:34,emails:3,touchpoints:5,followups:2,status:"AT RISK"},
  {company:"Mezlan",domain:"mezlan.com",traffic:127908,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-28",daysSince:20,emails:2,touchpoints:3,followups:2,status:"AT RISK"},
  {company:"Saniderm",domain:"saniderm.com",traffic:105215,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-28",daysSince:20,emails:2,touchpoints:3,followups:2,status:"AT RISK"},
  {company:"Bandolierstyle",domain:"bandolierstyle.com",traffic:177391,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-29",daysSince:19,emails:7,touchpoints:8,followups:3,status:"AT RISK"},
  {company:"Matt & Nat",domain:"mattandnat.com",traffic:439059,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-02-03",daysSince:14,emails:4,touchpoints:5,followups:3,status:"AT RISK"},
  {company:"Onesizebeauty",domain:"onesizebeauty.com",traffic:139764,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-27",daysSince:21,emails:3,touchpoints:4,followups:3,status:"AT RISK"},
  {company:"Promescent",domain:"promescent.com",traffic:1320130,owner:"Darwish Gani",meetings:1,lastMeeting:"2025-11-12",daysSince:97,emails:3,touchpoints:4,followups:3,status:"AT RISK"},
  {company:"RIPNDIP",domain:"ripndip.com",traffic:null,owner:"Gregory Unger",meetings:1,lastMeeting:"2026-01-28",daysSince:20,emails:3,touchpoints:4,followups:3,status:"AT RISK"},
  {company:"KershKicks",domain:"kershkicks.co.uk",traffic:null,owner:"Brad Noble",meetings:2,lastMeeting:"2026-01-09",daysSince:39,emails:14,touchpoints:16,followups:8,status:"AT RISK"},
  {company:"Theskinnyfoodco",domain:"theskinnyfoodco.com",traffic:418417,owner:"Ash Luker",meetings:1,lastMeeting:"2026-02-06",daysSince:11,emails:14,touchpoints:15,followups:9,status:"AT RISK"},
  {company:"Yoto Limited",domain:"yotoplay.com",traffic:null,owner:"Ash Luker",meetings:1,lastMeeting:"2026-02-13",daysSince:4,emails:11,touchpoints:12,followups:9,status:"ACTIVE"},
  {company:"Books2Door",domain:"books2door.com",traffic:null,owner:"Ash Luker",meetings:1,lastMeeting:"2026-01-27",daysSince:21,emails:13,touchpoints:14,followups:13,status:"AT RISK"}
];

function formatTraffic(val) {
  if (val === null || val === undefined || val === '') return '&mdash;';
  return Number(val).toLocaleString();
}

function formatDaysSince(d) {
  if (d === null || d === undefined) return '&mdash;';
  if (d < 0) return '<span style="color:#16a34a;font-weight:500;">Upcoming</span>';
  if (d === 0) return 'Today';
  return d + ' days';
}

function statusBadge(s) {
  const map = {
    'ACTIVE':'badge-active',
    'NEEDS FOLLOW-UP':'badge-needs-followup',
    'AT RISK':'badge-at-risk',
    'NO FOLLOW-UP':'badge-no-followup',
    'DQ':'badge-dq'
  };
  return '<span class="badge '+(map[s]||'')+'">' + s + '</span>';
}

function renderNoOppoTable(data) {
  const tbody = document.getElementById('no-oppo-tbody');
  tbody.innerHTML = data.map(r => `<tr data-status="${r.status}" data-owner="${r.owner}" data-followups="${r.followups}" data-company="${r.company.toLowerCase()}" data-domain="${r.domain.toLowerCase()}">
    <td><strong>${r.company}</strong></td>
    <td>${r.domain}</td>
    <td class="traffic-val">${formatTraffic(r.traffic)}</td>
    <td>${r.owner || '<span style="color:#94a3b8;">Unassigned</span>'}</td>
    <td>${r.meetings}</td>
    <td>${r.lastMeeting || '&mdash;'}</td>
    <td>${formatDaysSince(r.daysSince)}</td>
    <td>${r.emails}</td>
    <td>${r.touchpoints}</td>
    <td>${r.followups}</td>
    <td>${statusBadge(r.status)}</td>
  </tr>`).join('');
  document.getElementById('showing-count').textContent = 'Showing ' + data.length + ' of 38';
}

function filterNoOppoTable() {
  const status = document.getElementById('filter-status').value;
  const owner = document.getElementById('filter-owner').value;
  const followups = document.getElementById('filter-followups').value;
  const search = document.getElementById('filter-search').value.toLowerCase().trim();

  let filtered = noOppoData.filter(r => {
    if (status !== 'all' && r.status !== status) return false;
    if (owner !== 'all' && r.owner !== owner) return false;
    if (followups === '0' && r.followups !== 0) return false;
    if (followups === '1-3' && (r.followups < 1 || r.followups > 3)) return false;
    if (followups === '4+' && r.followups < 4) return false;
    if (search && !r.company.toLowerCase().includes(search) && !r.domain.toLowerCase().includes(search)) return false;
    return true;
  });
  renderNoOppoTable(filtered);
}

// Initial render
renderNoOppoTable(noOppoData);

// ======================== TABLE SORTING ========================
const sortState = {};
function sortTable(tableId, colIdx) {
  const table = document.getElementById(tableId);
  const tbody = table.querySelector('tbody');
  const rows = Array.from(tbody.querySelectorAll('tr'));
  const key = tableId + '-' + colIdx;
  sortState[key] = sortState[key] === 'asc' ? 'desc' : 'asc';
  const dir = sortState[key] === 'asc' ? 1 : -1;

  // Clear sort classes
  table.querySelectorAll('th').forEach(th => th.classList.remove('sort-asc','sort-desc'));
  table.querySelectorAll('th')[colIdx].classList.add(sortState[key] === 'asc' ? 'sort-asc' : 'sort-desc');

  rows.sort((a, b) => {
    let aVal = a.cells[colIdx].textContent.trim();
    let bVal = b.cells[colIdx].textContent.trim();
    // Try numeric
    let aNum = parseFloat(aVal.replace(/[$,]/g, ''));
    let bNum = parseFloat(bVal.replace(/[$,]/g, ''));
    if (!isNaN(aNum) && !isNaN(bNum)) return (aNum - bNum) * dir;
    // handle mdash
    if (aVal === '\u2014') aVal = '';
    if (bVal === '\u2014') bVal = '';
    return aVal.localeCompare(bVal, undefined, {numeric: true}) * dir;
  });
  rows.forEach(r => tbody.appendChild(r));
}

// ======================== CHARTS ========================
function renderCharts() {
  const colors = {
    blue: '#2563eb', green: '#16a34a', amber: '#d97706', red: '#dc2626',
    purple: '#7c3aed', teal: '#0d9488', pink: '#ec4899', indigo: '#4f46e5',
    cyan: '#06b6d4', lime: '#84cc16', orange: '#f97316', slate: '#64748b'
  };

  // 1. Pipeline by Stage (doughnut)
  new Chart(document.getElementById('chart-pipeline'), {
    type: 'doughnut',
    data: {
      labels: ['Engaged ($185,442)', 'Qualified ($65,000)', 'Proposal ($20,000)', 'Closed Lost ($230,000)'],
      datasets: [{
        data: [185442, 65000, 20000, 230000],
        backgroundColor: [colors.green, colors.blue, colors.amber, colors.red],
        borderWidth: 2,
        borderColor: '#fff'
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'bottom', labels: { padding: 16, font: { size: 12 } } },
        tooltip: {
          callbacks: {
            label: function(ctx) {
              return ctx.label + ': $' + ctx.parsed.toLocaleString();
            }
          }
        }
      }
    }
  });

  // 2. Follow-ups After Opportunity (horizontal bar)
  new Chart(document.getElementById('chart-followups'), {
    type: 'bar',
    data: {
      labels: ['Goral-Shoes','Rayconglobal','Rowen & Wren','Bern Helmets','Kringle Candle','Revival Vintage','norasnursery.com','Mott & Bow','TruKid','Grayl','Country Life','Saintjavelin'],
      datasets: [{
        label: 'Follow-ups After Opportunity',
        data: [20,13,9,7,4,4,3,3,2,1,1,0],
        backgroundColor: [colors.green,colors.red,colors.green,colors.green,colors.amber,colors.green,colors.green,colors.blue,colors.green,colors.green,colors.green,colors.blue],
        borderRadius: 4,
        barThickness: 22
      }]
    },
    options: {
      indexAxis: 'y',
      responsive: true,
      plugins: { legend: { display: false } },
      scales: {
        x: { beginAtZero: true, title: { display: true, text: 'Number of Follow-ups', font: { size: 12 } } },
        y: { ticks: { font: { size: 11 } } }
      }
    }
  });

  // 3. Status Distribution (doughnut)
  new Chart(document.getElementById('chart-status'), {
    type: 'doughnut',
    data: {
      labels: ['Active (20)', 'Needs Follow-Up (5)', 'At Risk (11)', 'No Follow-Up (2)', 'DQ (1)'],
      datasets: [{
        data: [20, 5, 11, 2, 1],
        backgroundColor: [colors.green, colors.amber, colors.red, colors.slate, colors.purple],
        borderWidth: 2,
        borderColor: '#fff'
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'bottom', labels: { padding: 16, font: { size: 12 } } }
      }
    }
  });

  // 4. Top 10 Most Engaged Non-Oppo by Touchpoints
  new Chart(document.getElementById('chart-top10'), {
    type: 'bar',
    data: {
      labels: ['KershKicks','Theskinnyfoodco','Books2Door','Yoto Limited','Brandon Blackwood','Bandolierstyle','Cass Art','Krewe','Faherty Brand','Loveinfaith'],
      datasets: [{
        label: 'Total Touchpoints',
        data: [16,15,14,12,10,8,6,6,6,5],
        backgroundColor: colors.blue,
        borderRadius: 4,
        barThickness: 28
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'Total Touchpoints', font: { size: 12 } } },
        x: { ticks: { font: { size: 10 }, maxRotation: 45 } }
      }
    }
  });

  // 5. Activity by Sales Owner
  // Aggregate meetings and emails across ALL 50 companies
  const ownerStats = {};
  // Opportunity companies
  const oppoOwners = [
    {owner:'Gregory Unger',meetings:1,emails:1},   // Saintjavelin
    {owner:'Gregory Unger',meetings:2,emails:5},   // Bern Helmets
    {owner:'Gregory Unger',meetings:2,emails:2},   // TruKid
    {owner:'Gregory Unger',meetings:1,emails:2},   // norasnursery
    {owner:'Gregory Unger',meetings:1,emails:4},   // Grayl
    {owner:'Gregory Unger',meetings:1,emails:4},   // Kringle Candle
    {owner:'Brad Noble',meetings:3,emails:24},      // Rayconglobal
    {owner:'Ash Luker',meetings:3,emails:21},       // Goral-Shoes
    {owner:'Gregory Unger',meetings:2,emails:19},   // Revival Vintage
    {owner:'Brad Noble',meetings:1,emails:19},      // Mott & Bow
    {owner:'Ash Luker',meetings:1,emails:25},       // Rowen & Wren
    {owner:'Gregory Unger',meetings:1,emails:1},    // Country Life
  ];
  oppoOwners.forEach(r => {
    if (!ownerStats[r.owner]) ownerStats[r.owner] = {meetings:0, emails:0};
    ownerStats[r.owner].meetings += r.meetings;
    ownerStats[r.owner].emails += r.emails;
  });
  noOppoData.forEach(r => {
    const o = r.owner || 'Unassigned';
    if (!ownerStats[o]) ownerStats[o] = {meetings:0, emails:0};
    ownerStats[o].meetings += r.meetings;
    ownerStats[o].emails += r.emails;
  });

  const ownerLabels = Object.keys(ownerStats).sort((a,b) => {
    const totalA = ownerStats[a].meetings + ownerStats[a].emails;
    const totalB = ownerStats[b].meetings + ownerStats[b].emails;
    return totalB - totalA;
  });

  new Chart(document.getElementById('chart-owners'), {
    type: 'bar',
    data: {
      labels: ownerLabels,
      datasets: [
        {
          label: 'Meetings',
          data: ownerLabels.map(o => ownerStats[o].meetings),
          backgroundColor: colors.blue,
          borderRadius: 4
        },
        {
          label: 'Outbound Emails',
          data: ownerLabels.map(o => ownerStats[o].emails),
          backgroundColor: colors.teal,
          borderRadius: 4
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'bottom', labels: { padding: 16, font: { size: 12 } } }
      },
      scales: {
        y: { beginAtZero: true, stacked: false, title: { display: true, text: 'Count', font: { size: 12 } } },
        x: { ticks: { font: { size: 11 } } }
      }
    }
  });
}
</script>
</body>
</html>